<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sentiment Analysis Demo</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
<h2>Sentiment Analysis with Amazon Comprehend</h2>
<button id="loadReviews">Load Reviews</button>
<div id="reviews"></div>
<button id="analyze">Analyze Sentiment</button>
<div id="result"></div>

<script>
  $(document).ready(function() {
    $("#loadReviews").click(function () {
      $.get('https://ci93aqakkb.execute-api.us-east-2.amazonaws.com/prod/fetchReviews', function (data) {
        $('#reviews').html("");
        if (data && data.reviews && Array.isArray(data.reviews)) {
          data.reviews.forEach(review => {
            $('#reviews').append(`<p>${review}</p>`);
          });
        } else {
          console.error("Unexpected data structure:", data);
        }
      });
    });
    $("#analyze").click(function () {
      const reviewsToAnalyze = $('#reviews').text().split("\n\n").filter(Boolean);  // Adjust the delimiter if necessary
      console.log("Reviews to Analyze:", reviewsToAnalyze);

      $.post('https://ci93aqakkb.execute-api.us-east-2.amazonaws.com/prod/analyzeSentiment', JSON.stringify({reviews: reviewsToAnalyze}), function (data) {
        console.log("Received Data:", data);

        $('#result').html("");
        if (data && data.results && Array.isArray(data.results)) {
          data.results.forEach(res => {
            $('#result').append(`<p>Review: ${res.review} - Sentiment: ${res.sentiment}</p>`);
          });
        } else {
          console.error("Unexpected data structure:", data);
        }
      });
    });
  });

</script>
</body>
</html>
